{"ast":null,"code":"import _taggedTemplateLiteral from\"D:/IdeaProjects/valuemap/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import React,{useState,useRef}from'react';import SignatureCanvas from'react-signature-canvas';import styled from'styled-components';import{Buffer}from\"buffer\";import axios from\"axios\";import dayjs from\"dayjs\";import cn from'classnames';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CanvasWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: relative;\\n  background-color : white;\\n  width: 350px;\\n  height: 200px;\\n\"])));const CanvasPlaceholder=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n    background-color : white;\\n  transform: translate(-50%, -50%);\\n  color: black;\\n\"])));const Signature=_ref=>{let{name,setMsg,setIsOpen,setSign}=_ref;const canvasRef=useRef(null);const[isSigned,setIsSigned]=useState(false);const save=async()=>{try{if(name){const image=canvasRef.current.getTrimmedCanvas().toDataURL('image/png');// image 변수에 이미지 다운로드 링크 할당, png를 jpg등의 다른 확장자로 변경 가능\nconst decodedURL=image.replace(/^data:image\\/\\w+;base64,/,'');const buf=Buffer.from(decodedURL,'base64');const blob=new Blob([buf],{type:'image/png'});const sign=new FormData();let today=dayjs().format('YYYY-MM-DD');const file=new File([blob],name+'_서명_'+today.toString().replaceAll('-','')+'.png',{type:'image/png'});sign.append('sign',file);const response=await axios.post('https://insurance-open-api.simg.kr/api/v1/prod/sign',sign,{headers:{'Content-Type':'multipart/form-data'}});if(response.status===200){setSign(response.data.signName);}else{setIsOpen(true);setMsg('서비스 오류입니다.');console.error('Error uploading images:',response.statusText);}}else{alert('이릅을 입력해주세요.');}}catch(error){setIsOpen(true);setMsg('서비스 오류입니다.');console.log(error);}/*link.href = image; // a 태그의 href 속성으로 이미지 다운로드 링크\r\n        link.download = 'sign_image.png'; // 다운로드 파일의 기본 이름 설정\r\n        link.click(); // 임의의 a 태그를 클릭하여 다운로드 실행*/};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center  my-16 flex-col \",children:[/*#__PURE__*/_jsxs(CanvasWrapper,{className:\"border\",children:[!isSigned&&/*#__PURE__*/_jsx(CanvasPlaceholder,{children:\"\\uC5EC\\uAE30\\uC5D0 \\uC11C\\uBA85\\uC744 \\uD574\\uC8FC\\uC138\\uC694.\"}),/*#__PURE__*/_jsx(SignatureCanvas,{canvasProps:{width:'350px',height:'200px'},ref:canvasRef,onBegin:()=>{setIsSigned(true);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-[350px] mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:'button',className:\"basis-1/2 mx-8 py-2 border bg_base text-white rounded-lg\",onClick:event=>{canvasRef.current.clear();// 리셋\nsetIsSigned(false);setSign('');},children:\"\\uCD08\\uAE30\\uD654\"}),/*#__PURE__*/_jsx(\"button\",{type:'button',className:cn('basis-1/2 border mx-8 rounded-lg',{'bg-white':!isSigned,'bg_base text-white':isSigned}),disabled:!isSigned// 버튼 disabled\n,onClick:()=>save(),children:\"\\uD655\\uC778\"})]})]});};export default Signature;","map":{"version":3,"names":["React","useState","useRef","SignatureCanvas","styled","Buffer","axios","dayjs","cn","jsx","_jsx","jsxs","_jsxs","CanvasWrapper","div","_templateObject","_taggedTemplateLiteral","CanvasPlaceholder","_templateObject2","Signature","_ref","name","setMsg","setIsOpen","setSign","canvasRef","isSigned","setIsSigned","save","image","current","getTrimmedCanvas","toDataURL","decodedURL","replace","buf","from","blob","Blob","type","sign","FormData","today","format","file","File","toString","replaceAll","append","response","post","headers","status","data","signName","console","error","statusText","alert","log","className","children","canvasProps","width","height","ref","onBegin","onClick","event","clear","disabled"],"sources":["D:/IdeaProjects/valuemap/src/component/signature.tsx"],"sourcesContent":["import React, {useState, useRef} from 'react';\r\nimport SignatureCanvas from 'react-signature-canvas';\r\nimport styled from 'styled-components';\r\nimport {Buffer} from \"buffer\";\r\nimport axios from \"axios\";\r\nimport dayjs from \"dayjs\";\r\nimport cn from 'classnames';\r\n\r\nconst CanvasWrapper = styled.div`\r\n  position: relative;\r\n  background-color : white;\r\n  width: 350px;\r\n  height: 200px;\r\n`;\r\n\r\nconst CanvasPlaceholder = styled.div`\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n    background-color : white;\r\n  transform: translate(-50%, -50%);\r\n  color: black;\r\n`;\r\ninterface openType{\r\n    setMsg : React.Dispatch<React.SetStateAction<string>>;\r\n    setIsOpen : React.Dispatch<React.SetStateAction<boolean>>;\r\n    setSign : React.Dispatch<React.SetStateAction<any>>;\r\n    name : string;\r\n}\r\nconst Signature : React.FC<openType> = ({name, setMsg, setIsOpen,setSign}) => {\r\n    const canvasRef = useRef<any>(null);\r\n    const [isSigned, setIsSigned] = useState<boolean>(false);\r\n\r\n    const save = async () => {\r\n        try {\r\n            if(name){\r\n                const image = canvasRef.current.getTrimmedCanvas().toDataURL('image/png'); // image 변수에 이미지 다운로드 링크 할당, png를 jpg등의 다른 확장자로 변경 가능\r\n                const decodedURL = image.replace(/^data:image\\/\\w+;base64,/, '');\r\n                const buf = Buffer.from(decodedURL, 'base64');\r\n                const blob = new Blob([buf], { type: 'image/png' });\r\n                const sign = new FormData();\r\n                let today = dayjs().format('YYYY-MM-DD');\r\n                const file = new File([blob], name + '_서명_' + today.toString().replaceAll('-', '') + '.png', { type: 'image/png' });\r\n                sign.append('sign',file);\r\n                const response = await axios.post('https://insurance-open-api.simg.kr/api/v1/prod/sign', sign, {\r\n                    headers: {\r\n                        'Content-Type': 'multipart/form-data',\r\n                    },\r\n                });\r\n\r\n                if (response.status === 200) {\r\n                    setSign(response.data.signName);\r\n                } else {\r\n                    setIsOpen(true);\r\n                    setMsg('서비스 오류입니다.');\r\n                    console.error('Error uploading images:', response.statusText);\r\n                }\r\n            }else {\r\n                alert('이릅을 입력해주세요.');\r\n            }\r\n        }catch(error) {\r\n            setIsOpen(true);\r\n            setMsg('서비스 오류입니다.')\r\n            console.log(error);\r\n        }\r\n\r\n        /*link.href = image; // a 태그의 href 속성으로 이미지 다운로드 링크\r\n        link.download = 'sign_image.png'; // 다운로드 파일의 기본 이름 설정\r\n        link.click(); // 임의의 a 태그를 클릭하여 다운로드 실행*/\r\n    };\r\n    return (\r\n        <div className='flex justify-center items-center  my-16 flex-col '>\r\n            <CanvasWrapper className = 'border'>\r\n                {!isSigned && (\r\n                    <CanvasPlaceholder>\r\n                        여기에 서명을 해주세요.\r\n                    </CanvasPlaceholder>\r\n                )}\r\n                <SignatureCanvas\r\n                    canvasProps={{width : '350px', height : '200px'}}\r\n                    ref={canvasRef}\r\n                    onBegin={() => {\r\n                        setIsSigned(true);\r\n                    }}\r\n                />\r\n            </CanvasWrapper>\r\n            <div className='flex w-[350px] mt-4'>\r\n                <button\r\n                    type={'button'}\r\n                    className='basis-1/2 mx-8 py-2 border bg_base text-white rounded-lg'\r\n                    onClick={(event : React.MouseEvent<HTMLButtonElement>) => {\r\n                        canvasRef.current.clear(); // 리셋\r\n                        setIsSigned(false);\r\n                        setSign('');\r\n                    }}\r\n                >\r\n                    초기화\r\n                </button>\r\n                <button\r\n                    type={'button'}\r\n                    className={cn('basis-1/2 border mx-8 rounded-lg',{'bg-white': !isSigned, 'bg_base text-white' : isSigned})}\r\n                    disabled={!isSigned} // 버튼 disabled\r\n                    onClick={() => save()}\r\n                >\r\n                    확인\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Signature;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}