{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Document,Page,pdfjs}from'react-pdf';import{useMediaQuery}from\"react-responsive\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";pdfjs.GlobalWorkerOptions.workerSrc=\"//cdnjs.cloudflare.com/ajax/libs/pdf.js/\".concat(pdfjs.version,\"/pdf.worker.js\");function PdfView(_ref){let{setOpen,type}=_ref;const isPc=useMediaQuery({query:\"(min-width: 990px)\"});const[numPages,setNumPages]=useState(null);const[pageNumber,setPageNumber]=useState(1);const[pdfUrl,setPdfUrl]=useState('');const onDocumentLoadSuccess=_ref2=>{let{numPages}=_ref2;setNumPages(numPages);};const changePage=offset=>{setPageNumber(prevPageNumber=>prevPageNumber+offset);};const previousPage=()=>{changePage(-1);};const nextPage=()=>{changePage(1);};const downloadPdf=()=>{//const pdfUrl = 'https://test-mycheckup-insu.simg.kr/download-pdf';\n// PDF 파일 다운로드 링크 생성\nconst link=document.createElement('a');link.href=pdfUrl;let name=sessionStorage.getItem('name');if(type==='pdf')link.setAttribute('download','프로미 용종보험_보험약관.pdf');if(type==='regi')link.setAttribute('download',\"\".concat(name,\" \\uBCF4\\uD5D8\\uAC00\\uC785 \\uC99D\\uBA85\\uC11C.pdf\"));document.body.appendChild(link);link.click();document.body.removeChild(link);};useEffect(()=>{if(type==='regi'){const getPdfUrl=async()=>{try{let cmpk=sessionStorage.getItem('cmpk');let join=sessionStorage.getItem('join');console.log(join);const response=await axios.get(\"https://mycheckup-insu.simg.kr/get-pdf?key=\".concat(cmpk,\"&today=\").concat(join),{responseType:'blob'});const pdfBlob=new Blob([response.data],{type:'application/pdf'});setPdfUrl(URL.createObjectURL(pdfBlob));}catch(error){alert('서비스 오류입니다. \\n본사에 문의주시기 바랍니다. \\n☎ 1877-3006');console.error('Error fetching PDF:',error);}};getPdfUrl();}else{setPdfUrl('/insuTerms.pdf');}},[]);// @ts-ignore\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-full  flex_center flex-col bg-white\",children:[/*#__PURE__*/_jsx(Document,{file:pdfUrl,onLoadSuccess:onDocumentLoadSuccess,children:/*#__PURE__*/_jsx(Page,{pageNumber:pageNumber,width:isPc?600:400})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col absolute bottom-0 bg-white w-full pb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_center space-x-6\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:pageNumber<=1,onClick:previousPage,children:\"\\uC774\\uC804 \\uD398\\uC774\\uC9C0\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Page \",pageNumber,\" of \",numPages]}),/*#__PURE__*/_jsx(\"button\",{disabled:pageNumber>=(numPages||1),onClick:nextPage,children:\"\\uB2E4\\uC74C \\uD398\\uC774\\uC9C0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-6 flex_center mt-4 text-white\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"button-color\",onClick:event=>setOpen(false),children:\"\\uB2EB\\uAE30\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button-color\",onClick:downloadPdf,children:\"\\uC800\\uC7A5\"})]})]})]});};export default PdfView;","map":{"version":3,"names":["React","useState","useEffect","axios","Document","Page","pdfjs","useMediaQuery","jsx","_jsx","jsxs","_jsxs","GlobalWorkerOptions","workerSrc","concat","version","PdfView","_ref","setOpen","type","isPc","query","numPages","setNumPages","pageNumber","setPageNumber","pdfUrl","setPdfUrl","onDocumentLoadSuccess","_ref2","changePage","offset","prevPageNumber","previousPage","nextPage","downloadPdf","link","document","createElement","href","name","sessionStorage","getItem","setAttribute","body","appendChild","click","removeChild","getPdfUrl","cmpk","join","console","log","response","get","responseType","pdfBlob","Blob","data","URL","createObjectURL","error","alert","className","children","file","onLoadSuccess","width","disabled","onClick","event"],"sources":["D:/project/mycheckup/src/component/pdfView.tsx"],"sourcesContent":["import React, {SetStateAction, useState, useEffect} from 'react';\r\nimport axios from 'axios';\r\nimport { Document, Page, pdfjs  } from 'react-pdf';\r\nimport { useMediaQuery } from \"react-responsive\";\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\ntype Props = {\r\n    pdfUrl: string;\r\n    setOpen : React.Dispatch<SetStateAction<boolean>>;\r\n    type : string;\r\n};\r\n\r\n\r\nfunction PdfView ({setOpen, type } : Props)  {\r\n    const isPc = useMediaQuery({ query: \"(min-width: 990px)\" });\r\n    const [numPages, setNumPages] = useState<number | null>(null);\r\n    const [pageNumber, setPageNumber] = useState<number>(1);\r\n    const [pdfUrl, setPdfUrl] = useState('');\r\n\r\n\r\n    const onDocumentLoadSuccess = ({ numPages } : any) => {\r\n        setNumPages(numPages);\r\n    };\r\n\r\n\r\n    const changePage = (offset: number) => {\r\n        setPageNumber(prevPageNumber => prevPageNumber + offset);\r\n    };\r\n\r\n    const previousPage = () => {\r\n        changePage(-1);\r\n    };\r\n\r\n    const nextPage = () => {\r\n        changePage(1);\r\n    };\r\n    const downloadPdf = () => {\r\n        //const pdfUrl = 'https://test-mycheckup-insu.simg.kr/download-pdf';\r\n        // PDF 파일 다운로드 링크 생성\r\n        const link = document.createElement('a');\r\n        link.href = pdfUrl;\r\n        let name = sessionStorage.getItem('name');\r\n        if(type === 'pdf') link.setAttribute('download', '프로미 용종보험_보험약관.pdf');\r\n        if(type === 'regi') link.setAttribute('download', `${name} 보험가입 증명서.pdf`);\r\n\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(type === 'regi'){\r\n            const getPdfUrl = async () => {\r\n                try {\r\n                    let cmpk = sessionStorage.getItem('cmpk');\r\n                    let join = sessionStorage.getItem('join');\r\n                    console.log(join);\r\n                    const response = await axios.get(`https://mycheckup-insu.simg.kr/get-pdf?key=${cmpk}&today=${join}`, {\r\n                        responseType: 'blob'\r\n                    });\r\n                    const pdfBlob = new Blob([response.data], {type: 'application/pdf'});\r\n                    setPdfUrl(URL.createObjectURL(pdfBlob));\r\n                } catch (error) {\r\n                    alert('서비스 오류입니다. \\n본사에 문의주시기 바랍니다. \\n☎ 1877-3006');\r\n                    console.error('Error fetching PDF:', error);\r\n                }\r\n            };\r\n            getPdfUrl();\r\n        }else {\r\n            setPdfUrl('/insuTerms.pdf');\r\n        }\r\n    }, []);\r\n    // @ts-ignore\r\n    return (\r\n        <div className='w-full h-full  flex_center flex-col bg-white'>\r\n            <Document\r\n                file={pdfUrl}\r\n                onLoadSuccess={onDocumentLoadSuccess}\r\n            >\r\n                <Page pageNumber={pageNumber} width={isPc ? 600 : 400}/>\r\n            </Document>\r\n            <div className='flex flex-col absolute bottom-0 bg-white w-full pb-4'>\r\n                <div className='flex_center space-x-6'>\r\n                    <button disabled={pageNumber <= 1} onClick={previousPage}>\r\n                        이전 페이지\r\n                    </button>\r\n                    <p>Page {pageNumber} of {numPages}</p>\r\n                    <button disabled={pageNumber >= (numPages || 1)} onClick={nextPage}>\r\n                        다음 페이지\r\n                    </button>\r\n                </div>\r\n                <div className='flex space-x-6 flex_center mt-4 text-white'>\r\n                    <button className='button-color' onClick={(event : React.MouseEvent<HTMLButtonElement>) => setOpen(false)}>닫기</button>\r\n                    <button className='button-color' onClick={downloadPdf}>저장</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PdfView;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAmBC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CAChE,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,IAAI,CAAEC,KAAK,KAAS,WAAW,CAClD,OAASC,aAAa,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjDL,KAAK,CAACM,mBAAmB,CAACC,SAAS,4CAAAC,MAAA,CAA8CR,KAAK,CAACS,OAAO,kBAAgB,CAQ9G,QAAS,CAAAC,OAAOA,CAAAC,IAAA,CAA6B,IAA3B,CAACC,OAAO,CAAEC,IAAa,CAAC,CAAAF,IAAA,CACtC,KAAM,CAAAG,IAAI,CAAGb,aAAa,CAAC,CAAEc,KAAK,CAAE,oBAAqB,CAAC,CAAC,CAC3D,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGtB,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAACuB,UAAU,CAAEC,aAAa,CAAC,CAAGxB,QAAQ,CAAS,CAAC,CAAC,CACvD,KAAM,CAACyB,MAAM,CAAEC,SAAS,CAAC,CAAG1B,QAAQ,CAAC,EAAE,CAAC,CAGxC,KAAM,CAAA2B,qBAAqB,CAAGC,KAAA,EAAwB,IAAvB,CAAEP,QAAe,CAAC,CAAAO,KAAA,CAC7CN,WAAW,CAACD,QAAQ,CAAC,CACzB,CAAC,CAGD,KAAM,CAAAQ,UAAU,CAAIC,MAAc,EAAK,CACnCN,aAAa,CAACO,cAAc,EAAIA,cAAc,CAAGD,MAAM,CAAC,CAC5D,CAAC,CAED,KAAM,CAAAE,YAAY,CAAGA,CAAA,GAAM,CACvBH,UAAU,CAAC,CAAC,CAAC,CAAC,CAClB,CAAC,CAED,KAAM,CAAAI,QAAQ,CAAGA,CAAA,GAAM,CACnBJ,UAAU,CAAC,CAAC,CAAC,CACjB,CAAC,CACD,KAAM,CAAAK,WAAW,CAAGA,CAAA,GAAM,CACtB;AACA;AACA,KAAM,CAAAC,IAAI,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,IAAI,CAACG,IAAI,CAAGb,MAAM,CAClB,GAAI,CAAAc,IAAI,CAAGC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CACzC,GAAGvB,IAAI,GAAK,KAAK,CAAEiB,IAAI,CAACO,YAAY,CAAC,UAAU,CAAE,mBAAmB,CAAC,CACrE,GAAGxB,IAAI,GAAK,MAAM,CAAEiB,IAAI,CAACO,YAAY,CAAC,UAAU,IAAA7B,MAAA,CAAK0B,IAAI,oDAAe,CAAC,CAEzEH,QAAQ,CAACO,IAAI,CAACC,WAAW,CAACT,IAAI,CAAC,CAC/BA,IAAI,CAACU,KAAK,CAAC,CAAC,CACZT,QAAQ,CAACO,IAAI,CAACG,WAAW,CAACX,IAAI,CAAC,CACnC,CAAC,CAEDlC,SAAS,CAAC,IAAM,CACZ,GAAGiB,IAAI,GAAK,MAAM,CAAC,CACf,KAAM,CAAA6B,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACA,GAAI,CAAAC,IAAI,CAAGR,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CACzC,GAAI,CAAAQ,IAAI,CAAGT,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CACzCS,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACjB,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAlD,KAAK,CAACmD,GAAG,+CAAAxC,MAAA,CAA+CmC,IAAI,YAAAnC,MAAA,CAAUoC,IAAI,EAAI,CACjGK,YAAY,CAAE,MAClB,CAAC,CAAC,CACF,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACJ,QAAQ,CAACK,IAAI,CAAC,CAAE,CAACvC,IAAI,CAAE,iBAAiB,CAAC,CAAC,CACpEQ,SAAS,CAACgC,GAAG,CAACC,eAAe,CAACJ,OAAO,CAAC,CAAC,CAC3C,CAAE,MAAOK,KAAK,CAAE,CACZC,KAAK,CAAC,4CAA4C,CAAC,CACnDX,OAAO,CAACU,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC/C,CACJ,CAAC,CACDb,SAAS,CAAC,CAAC,CACf,CAAC,IAAK,CACFrB,SAAS,CAAC,gBAAgB,CAAC,CAC/B,CACJ,CAAC,CAAE,EAAE,CAAC,CACN;AACA,mBACIhB,KAAA,QAAKoD,SAAS,CAAC,8CAA8C,CAAAC,QAAA,eACzDvD,IAAA,CAACL,QAAQ,EACL6D,IAAI,CAAEvC,MAAO,CACbwC,aAAa,CAAEtC,qBAAsB,CAAAoC,QAAA,cAErCvD,IAAA,CAACJ,IAAI,EAACmB,UAAU,CAAEA,UAAW,CAAC2C,KAAK,CAAE/C,IAAI,CAAG,GAAG,CAAG,GAAI,CAAC,CAAC,CAClD,CAAC,cACXT,KAAA,QAAKoD,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eACjErD,KAAA,QAAKoD,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eAClCvD,IAAA,WAAQ2D,QAAQ,CAAE5C,UAAU,EAAI,CAAE,CAAC6C,OAAO,CAAEpC,YAAa,CAAA+B,QAAA,CAAC,iCAE1D,CAAQ,CAAC,cACTrD,KAAA,MAAAqD,QAAA,EAAG,OAAK,CAACxC,UAAU,CAAC,MAAI,CAACF,QAAQ,EAAI,CAAC,cACtCb,IAAA,WAAQ2D,QAAQ,CAAE5C,UAAU,GAAKF,QAAQ,EAAI,CAAC,CAAE,CAAC+C,OAAO,CAAEnC,QAAS,CAAA8B,QAAA,CAAC,iCAEpE,CAAQ,CAAC,EACR,CAAC,cACNrD,KAAA,QAAKoD,SAAS,CAAC,4CAA4C,CAAAC,QAAA,eACvDvD,IAAA,WAAQsD,SAAS,CAAC,cAAc,CAACM,OAAO,CAAGC,KAA2C,EAAKpD,OAAO,CAAC,KAAK,CAAE,CAAA8C,QAAA,CAAC,cAAE,CAAQ,CAAC,cACtHvD,IAAA,WAAQsD,SAAS,CAAC,cAAc,CAACM,OAAO,CAAElC,WAAY,CAAA6B,QAAA,CAAC,cAAE,CAAQ,CAAC,EACjE,CAAC,EACL,CAAC,EACL,CAAC,CAEd,CAAC,CAED,cAAe,CAAAhD,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}