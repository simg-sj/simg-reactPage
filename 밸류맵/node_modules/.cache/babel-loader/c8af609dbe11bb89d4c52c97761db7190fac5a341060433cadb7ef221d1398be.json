{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Document,Page,pdfjs}from'react-pdf';import{useMediaQuery}from\"react-responsive\";import{downloadPdf}from'../utils/common';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";pdfjs.GlobalWorkerOptions.workerSrc=\"//cdnjs.cloudflare.com/ajax/libs/pdf.js/\".concat(pdfjs.version,\"/pdf.worker.js\");function PdfView(_ref){let{setOpen,type}=_ref;const isPc=useMediaQuery({query:\"(min-width: 990px)\"});const[numPages,setNumPages]=useState(null);const[pageNumber,setPageNumber]=useState(1);const[pdfUrl,setPdfUrl]=useState('');const onDocumentLoadSuccess=_ref2=>{let{numPages}=_ref2;setNumPages(numPages);};const changePage=offset=>{setPageNumber(prevPageNumber=>prevPageNumber+offset);};const previousPage=()=>{changePage(-1);};const nextPage=()=>{changePage(1);};const onClickHandler=()=>{//const pdfUrl = 'https://test-mycheckup-insu.simg.kr/download-pdf';\n// PDF 파일 다운로드 링크 생성\n/* const link = document.createElement('a');\r\n        link.href = pdfUrl;\r\n        let name = sessionStorage.getItem('name');\r\n        if(type === 'pdf') link.setAttribute('download', '프로미 임대차계약소송보험_보험약관.pdf');\r\n        if(type === 'regi') link.setAttribute('download', `${name} 보험가입 증명서.pdf`);\r\n\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);*/try{downloadPdf(pdfUrl,type);}catch(error){console.error('PDF 다운로드 중 오류 발생:',error);}};useEffect(()=>{if(type==='regi'){const getPdfUrl=async()=>{try{let cmpk=sessionStorage.getItem('cmpk');let join=sessionStorage.getItem('join');console.log(join);const response=await axios.get(\"https://insurance-info.simg.kr/get-pdf?key=\".concat(cmpk,\"&today=\").concat(join),{responseType:'blob'});const pdfBlob=new Blob([response.data],{type:'application/pdf'});setPdfUrl(URL.createObjectURL(pdfBlob));}catch(error){alert('서비스 오류입니다. \\n본사에 문의주시기 바랍니다. \\n☎ 1877-3006');console.error('Error fetching PDF:',error);}};getPdfUrl();}else{setPdfUrl('/프로미 임대차계약소송_보험약관.pdf');}},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-full  flex_center flex-col bg-white\",children:[/*#__PURE__*/_jsx(Document,{file:pdfUrl,onLoadSuccess:onDocumentLoadSuccess,children:/*#__PURE__*/_jsx(Page,{pageNumber:pageNumber,width:isPc?600:380})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col absolute bottom-0 bg-white w-full pb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_center space-x-6\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:pageNumber<=1,onClick:previousPage,children:\"\\uC774\\uC804 \\uD398\\uC774\\uC9C0\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Page \",pageNumber,\" of \",numPages]}),/*#__PURE__*/_jsx(\"button\",{disabled:pageNumber>=(numPages||1),onClick:nextPage,children:\"\\uB2E4\\uC74C \\uD398\\uC774\\uC9C0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-6 flex_center mt-4 text-white\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"button-color\",onClick:event=>setOpen(false),children:\"\\uB2EB\\uAE30\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button-color\",onClick:onClickHandler,children:\"\\uC800\\uC7A5\"})]})]})]});};export default PdfView;","map":{"version":3,"names":["React","useState","useEffect","axios","Document","Page","pdfjs","useMediaQuery","downloadPdf","jsx","_jsx","jsxs","_jsxs","GlobalWorkerOptions","workerSrc","concat","version","PdfView","_ref","setOpen","type","isPc","query","numPages","setNumPages","pageNumber","setPageNumber","pdfUrl","setPdfUrl","onDocumentLoadSuccess","_ref2","changePage","offset","prevPageNumber","previousPage","nextPage","onClickHandler","error","console","getPdfUrl","cmpk","sessionStorage","getItem","join","log","response","get","responseType","pdfBlob","Blob","data","URL","createObjectURL","alert","className","children","file","onLoadSuccess","width","disabled","onClick","event"],"sources":["D:/IdeaProjects/valuemap/src/component/pdfView.tsx"],"sourcesContent":["import React, {SetStateAction, useState, useEffect} from 'react';\r\nimport axios from 'axios';\r\nimport { Document, Page, pdfjs  } from 'react-pdf'\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport {downloadPdf} from '../utils/common';\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\ntype Props = {\r\n    setOpen : React.Dispatch<SetStateAction<boolean>>;\r\n    type : string;\r\n};\r\n\r\n\r\nfunction PdfView ({setOpen, type } : Props)  {\r\n    const isPc = useMediaQuery({ query: \"(min-width: 990px)\" });\r\n    const [numPages, setNumPages] = useState<number | null>(null);\r\n    const [pageNumber, setPageNumber] = useState<number>(1);\r\n    const [pdfUrl, setPdfUrl] = useState('');\r\n\r\n\r\n    const onDocumentLoadSuccess = ({ numPages } : any) => {\r\n        setNumPages(numPages);\r\n    };\r\n\r\n\r\n    const changePage = (offset: number) => {\r\n        setPageNumber(prevPageNumber => prevPageNumber + offset);\r\n    };\r\n\r\n    const previousPage = () => {\r\n        changePage(-1);\r\n    };\r\n\r\n    const nextPage = () => {\r\n        changePage(1);\r\n    };\r\n    const onClickHandler = () => {\r\n        //const pdfUrl = 'https://test-mycheckup-insu.simg.kr/download-pdf';\r\n        // PDF 파일 다운로드 링크 생성\r\n       /* const link = document.createElement('a');\r\n        link.href = pdfUrl;\r\n        let name = sessionStorage.getItem('name');\r\n        if(type === 'pdf') link.setAttribute('download', '프로미 임대차계약소송보험_보험약관.pdf');\r\n        if(type === 'regi') link.setAttribute('download', `${name} 보험가입 증명서.pdf`);\r\n\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);*/\r\n        try {\r\n             downloadPdf(pdfUrl, type)\r\n        } catch (error) {\r\n            console.error('PDF 다운로드 중 오류 발생:', error);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(type === 'regi'){\r\n            const getPdfUrl = async () => {\r\n                try {\r\n                    let cmpk = sessionStorage.getItem('cmpk');\r\n                    let join = sessionStorage.getItem('join');\r\n                    console.log(join);\r\n                    const response = await axios.get(`https://insurance-info.simg.kr/get-pdf?key=${cmpk}&today=${join}`, {\r\n                        responseType: 'blob'\r\n                    });\r\n                    const pdfBlob = new Blob([response.data], {type: 'application/pdf'});\r\n                    setPdfUrl(URL.createObjectURL(pdfBlob));\r\n                } catch (error) {\r\n                    alert('서비스 오류입니다. \\n본사에 문의주시기 바랍니다. \\n☎ 1877-3006');\r\n                    console.error('Error fetching PDF:', error);\r\n                }\r\n            };\r\n            getPdfUrl();\r\n        }else {\r\n            setPdfUrl('/프로미 임대차계약소송_보험약관.pdf');\r\n        }\r\n    }, []);\r\n    return (\r\n        <div className='w-full h-full  flex_center flex-col bg-white'>\r\n            <Document\r\n                file={pdfUrl}\r\n                onLoadSuccess={onDocumentLoadSuccess}\r\n            >\r\n                <Page pageNumber={pageNumber} width={isPc ? 600 : 380}/>\r\n            </Document>\r\n            <div className='flex flex-col absolute bottom-0 bg-white w-full pb-4'>\r\n                <div className='flex_center space-x-6'>\r\n                    <button disabled={pageNumber <= 1} onClick={previousPage}>\r\n                        이전 페이지\r\n                    </button>\r\n                    <p>Page {pageNumber} of {numPages}</p>\r\n                    <button disabled={pageNumber >= (numPages || 1)} onClick={nextPage}>\r\n                        다음 페이지\r\n                    </button>\r\n                </div>\r\n                <div className='flex space-x-6 flex_center mt-4 text-white'>\r\n                    <button className='button-color' onClick={(event : React.MouseEvent<HTMLButtonElement>) => setOpen(false)}>닫기</button>\r\n                    <button className='button-color' onClick={onClickHandler}>저장</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PdfView;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAmBC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CAChE,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,IAAI,CAAEC,KAAK,KAAS,WAAW,CAClD,OAASC,aAAa,KAAQ,kBAAkB,CAChD,OAAQC,WAAW,KAAO,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAC5CN,KAAK,CAACO,mBAAmB,CAACC,SAAS,4CAAAC,MAAA,CAA8CT,KAAK,CAACU,OAAO,kBAAgB,CAO9G,QAAS,CAAAC,OAAOA,CAAAC,IAAA,CAA6B,IAA3B,CAACC,OAAO,CAAEC,IAAa,CAAC,CAAAF,IAAA,CACtC,KAAM,CAAAG,IAAI,CAAGd,aAAa,CAAC,CAAEe,KAAK,CAAE,oBAAqB,CAAC,CAAC,CAC3D,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGvB,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAACwB,UAAU,CAAEC,aAAa,CAAC,CAAGzB,QAAQ,CAAS,CAAC,CAAC,CACvD,KAAM,CAAC0B,MAAM,CAAEC,SAAS,CAAC,CAAG3B,QAAQ,CAAC,EAAE,CAAC,CAGxC,KAAM,CAAA4B,qBAAqB,CAAGC,KAAA,EAAwB,IAAvB,CAAEP,QAAe,CAAC,CAAAO,KAAA,CAC7CN,WAAW,CAACD,QAAQ,CAAC,CACzB,CAAC,CAGD,KAAM,CAAAQ,UAAU,CAAIC,MAAc,EAAK,CACnCN,aAAa,CAACO,cAAc,EAAIA,cAAc,CAAGD,MAAM,CAAC,CAC5D,CAAC,CAED,KAAM,CAAAE,YAAY,CAAGA,CAAA,GAAM,CACvBH,UAAU,CAAC,CAAC,CAAC,CAAC,CAClB,CAAC,CAED,KAAM,CAAAI,QAAQ,CAAGA,CAAA,GAAM,CACnBJ,UAAU,CAAC,CAAC,CAAC,CACjB,CAAC,CACD,KAAM,CAAAK,cAAc,CAAGA,CAAA,GAAM,CACzB;AACA;AACD;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CACQ,GAAI,CACC5B,WAAW,CAACmB,MAAM,CAAEP,IAAI,CAAC,CAC9B,CAAE,MAAOiB,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,mBAAmB,CAAEA,KAAK,CAAC,CAC7C,CACJ,CAAC,CAEDnC,SAAS,CAAC,IAAM,CACZ,GAAGkB,IAAI,GAAK,MAAM,CAAC,CACf,KAAM,CAAAmB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACA,GAAI,CAAAC,IAAI,CAAGC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CACzC,GAAI,CAAAC,IAAI,CAAGF,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CACzCJ,OAAO,CAACM,GAAG,CAACD,IAAI,CAAC,CACjB,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAA1C,KAAK,CAAC2C,GAAG,+CAAA/B,MAAA,CAA+CyB,IAAI,YAAAzB,MAAA,CAAU4B,IAAI,EAAI,CACjGI,YAAY,CAAE,MAClB,CAAC,CAAC,CACF,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACJ,QAAQ,CAACK,IAAI,CAAC,CAAE,CAAC9B,IAAI,CAAE,iBAAiB,CAAC,CAAC,CACpEQ,SAAS,CAACuB,GAAG,CAACC,eAAe,CAACJ,OAAO,CAAC,CAAC,CAC3C,CAAE,MAAOX,KAAK,CAAE,CACZgB,KAAK,CAAC,4CAA4C,CAAC,CACnDf,OAAO,CAACD,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC/C,CACJ,CAAC,CACDE,SAAS,CAAC,CAAC,CACf,CAAC,IAAK,CACFX,SAAS,CAAC,uBAAuB,CAAC,CACtC,CACJ,CAAC,CAAE,EAAE,CAAC,CACN,mBACIhB,KAAA,QAAK0C,SAAS,CAAC,8CAA8C,CAAAC,QAAA,eACzD7C,IAAA,CAACN,QAAQ,EACLoD,IAAI,CAAE7B,MAAO,CACb8B,aAAa,CAAE5B,qBAAsB,CAAA0B,QAAA,cAErC7C,IAAA,CAACL,IAAI,EAACoB,UAAU,CAAEA,UAAW,CAACiC,KAAK,CAAErC,IAAI,CAAG,GAAG,CAAG,GAAI,CAAC,CAAC,CAClD,CAAC,cACXT,KAAA,QAAK0C,SAAS,CAAC,sDAAsD,CAAAC,QAAA,eACjE3C,KAAA,QAAK0C,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eAClC7C,IAAA,WAAQiD,QAAQ,CAAElC,UAAU,EAAI,CAAE,CAACmC,OAAO,CAAE1B,YAAa,CAAAqB,QAAA,CAAC,iCAE1D,CAAQ,CAAC,cACT3C,KAAA,MAAA2C,QAAA,EAAG,OAAK,CAAC9B,UAAU,CAAC,MAAI,CAACF,QAAQ,EAAI,CAAC,cACtCb,IAAA,WAAQiD,QAAQ,CAAElC,UAAU,GAAKF,QAAQ,EAAI,CAAC,CAAE,CAACqC,OAAO,CAAEzB,QAAS,CAAAoB,QAAA,CAAC,iCAEpE,CAAQ,CAAC,EACR,CAAC,cACN3C,KAAA,QAAK0C,SAAS,CAAC,4CAA4C,CAAAC,QAAA,eACvD7C,IAAA,WAAQ4C,SAAS,CAAC,cAAc,CAACM,OAAO,CAAGC,KAA2C,EAAK1C,OAAO,CAAC,KAAK,CAAE,CAAAoC,QAAA,CAAC,cAAE,CAAQ,CAAC,cACtH7C,IAAA,WAAQ4C,SAAS,CAAC,cAAc,CAACM,OAAO,CAAExB,cAAe,CAAAmB,QAAA,CAAC,cAAE,CAAQ,CAAC,EACpE,CAAC,EACL,CAAC,EACL,CAAC,CAEd,CAAC,CAED,cAAe,CAAAtC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}