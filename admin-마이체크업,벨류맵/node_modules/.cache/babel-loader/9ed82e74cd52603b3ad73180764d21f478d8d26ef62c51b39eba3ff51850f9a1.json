{"ast":null,"code":"import * as XLSX from \"xlsx\";\nimport dayjs from 'dayjs';\nexport function getCompany() {\n  const company = [{\n    code: '01',\n    name: '마이체크업'\n  }, {\n    code: '02',\n    name: '벨류맵'\n  }];\n  return company;\n}\nexport function getCode(type) {\n  const company = [{\n    type: '01',\n    code: '1',\n    name: '마이체크업'\n  }, {\n    type: '02',\n    code: '02',\n    name: '벨류맵'\n  }];\n  for (let idx of company) {\n    if (idx.type === type) return idx.code;\n  }\n  return '00';\n}\nexport function excelDownload(type, data) {\n  let today = dayjs().format('YYYY-MM-DD');\n  const excelHandler = {\n    getExcelFileName: () => {\n      return \"유저 데이터.xlsx\";\n    },\n    getSheetName: () => {\n      return today + '_' + type;\n    },\n    getExcelData: () => {\n      return data;\n    },\n    getWorksheet: () => {\n      return XLSX.utils.json_to_sheet(excelHandler.getExcelData());\n    }\n  };\n  const datas = excelHandler.getWorksheet();\n  const workbook = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(workbook, datas, excelHandler.getSheetName());\n  XLSX.writeFile(workbook, excelHandler.getExcelFileName());\n}","map":{"version":3,"names":["XLSX","dayjs","getCompany","company","code","name","getCode","type","idx","excelDownload","data","today","format","excelHandler","getExcelFileName","getSheetName","getExcelData","getWorksheet","utils","json_to_sheet","datas","workbook","book_new","book_append_sheet","writeFile"],"sources":["D:/IdeaProjects/admin/src/utils/common.ts"],"sourcesContent":["import {Person} from '../@types/common';\r\nimport * as XLSX from \"xlsx\";\r\nimport dayjs from 'dayjs';\r\nimport getDate from \"../utils/getDate\";\r\n\r\nexport function getCompany(){\r\n    const company = [\r\n        {\r\n            code : '01',\r\n            name : '마이체크업'\r\n        },\r\n        {\r\n            code : '02',\r\n            name : '벨류맵'\r\n        }\r\n    ];\r\n\r\n    return company;\r\n}\r\nexport function getCode(type : string){\r\n    const company = [\r\n        {\r\n            type : '01',\r\n            code : '1',\r\n            name : '마이체크업'\r\n        },\r\n        {\r\n            type : '02',\r\n            code : '02',\r\n            name : '벨류맵'\r\n        }\r\n    ];\r\n\r\n    for(let idx of company){\r\n        if(idx.type === type) return idx.code;\r\n    }\r\n    return '00';\r\n}\r\n\r\nexport function excelDownload(type: string, data : Person[]){\r\n    let today = dayjs().format('YYYY-MM-DD');\r\n    const excelHandler = {\r\n        getExcelFileName: () => {\r\n            return \"유저 데이터.xlsx\";\r\n        },\r\n        getSheetName: ()  => {\r\n            return today+'_'+type;\r\n        },\r\n        getExcelData: () => {\r\n            return data ;\r\n        },\r\n        getWorksheet: () => {\r\n            return XLSX.utils.json_to_sheet(excelHandler.getExcelData());\r\n        },\r\n    };\r\n\r\n    const datas = excelHandler.getWorksheet();\r\n    const workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(workbook, datas, excelHandler.getSheetName());\r\n    XLSX.writeFile(workbook, excelHandler.getExcelFileName());\r\n}\r\n\r\n\r\n"],"mappings":"AACA,OAAO,KAAKA,IAAI,MAAM,MAAM;AAC5B,OAAOC,KAAK,MAAM,OAAO;AAGzB,OAAO,SAASC,UAAUA,CAAA,EAAE;EACxB,MAAMC,OAAO,GAAG,CACZ;IACIC,IAAI,EAAG,IAAI;IACXC,IAAI,EAAG;EACX,CAAC,EACD;IACID,IAAI,EAAG,IAAI;IACXC,IAAI,EAAG;EACX,CAAC,CACJ;EAED,OAAOF,OAAO;AAClB;AACA,OAAO,SAASG,OAAOA,CAACC,IAAa,EAAC;EAClC,MAAMJ,OAAO,GAAG,CACZ;IACII,IAAI,EAAG,IAAI;IACXH,IAAI,EAAG,GAAG;IACVC,IAAI,EAAG;EACX,CAAC,EACD;IACIE,IAAI,EAAG,IAAI;IACXH,IAAI,EAAG,IAAI;IACXC,IAAI,EAAG;EACX,CAAC,CACJ;EAED,KAAI,IAAIG,GAAG,IAAIL,OAAO,EAAC;IACnB,IAAGK,GAAG,CAACD,IAAI,KAAKA,IAAI,EAAE,OAAOC,GAAG,CAACJ,IAAI;EACzC;EACA,OAAO,IAAI;AACf;AAEA,OAAO,SAASK,aAAaA,CAACF,IAAY,EAAEG,IAAe,EAAC;EACxD,IAAIC,KAAK,GAAGV,KAAK,CAAC,CAAC,CAACW,MAAM,CAAC,YAAY,CAAC;EACxC,MAAMC,YAAY,GAAG;IACjBC,gBAAgB,EAAEA,CAAA,KAAM;MACpB,OAAO,aAAa;IACxB,CAAC;IACDC,YAAY,EAAEA,CAAA,KAAO;MACjB,OAAOJ,KAAK,GAAC,GAAG,GAACJ,IAAI;IACzB,CAAC;IACDS,YAAY,EAAEA,CAAA,KAAM;MAChB,OAAON,IAAI;IACf,CAAC;IACDO,YAAY,EAAEA,CAAA,KAAM;MAChB,OAAOjB,IAAI,CAACkB,KAAK,CAACC,aAAa,CAACN,YAAY,CAACG,YAAY,CAAC,CAAC,CAAC;IAChE;EACJ,CAAC;EAED,MAAMI,KAAK,GAAGP,YAAY,CAACI,YAAY,CAAC,CAAC;EACzC,MAAMI,QAAQ,GAAGrB,IAAI,CAACkB,KAAK,CAACI,QAAQ,CAAC,CAAC;EACtCtB,IAAI,CAACkB,KAAK,CAACK,iBAAiB,CAACF,QAAQ,EAAED,KAAK,EAAEP,YAAY,CAACE,YAAY,CAAC,CAAC,CAAC;EAC1Ef,IAAI,CAACwB,SAAS,CAACH,QAAQ,EAAER,YAAY,CAACC,gBAAgB,CAAC,CAAC,CAAC;AAC7D"},"metadata":{},"sourceType":"module","externalDependencies":[]}